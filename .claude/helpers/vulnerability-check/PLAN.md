# Plan: Vulnerability Check Scripts + Slash Command

## Context

Tool integrated into Claude Code that queries multiple security vulnerability databases. Enables asking "check lodash for vulns" or running `/vulnerability-check` to scan an entire project's dependencies. Four data sources: OSV.dev, GitHub Advisory Database, NCSC.nl, and CISA KEV.

## Architecture (revised)

- **Standalone Python scripts** invoked via Bash — no MCP server, zero context overhead
- **Slash command** `/vulnerability-check` orchestrates the scripts
- **File-based TTL cache** for large feeds (CISA KEV, NCSC)

## File Structure

```
.claude/helpers/vulnerability-check/
  query_osv.py        # Query OSV.dev
  query_github.py     # Query GitHub Advisory DB
  query_ncsc.py       # Query NCSC.nl advisories
  query_cisa.py       # Query CISA KEV catalog
  scan_deps.py        # Scan dependency file via OSV batch API
  parsers.py          # Dependency file parsers (7 formats)
  cache.py            # Simple file-based TTL cache
  pyproject.toml      # project config + deps (httpx)

.claude/commands/
  vulnerability-check.md   # Slash command
```

## Implementation Order

- [x] `cache.py` — standalone, no deps on other files
- [x] `parsers.py` — all 7 parsers with dispatcher function
- [x] `query_osv.py` — OSV.dev queries
- [x] `query_github.py` — GitHub Advisory DB queries
- [x] `query_ncsc.py` — NCSC.nl advisories (list-of-lists format)
- [x] `query_cisa.py` — CISA KEV catalog
- [x] `scan_deps.py` — batch dependency scanning
- [x] `vulnerability-check.md` — slash command
- [x] `pyproject.toml` — deps (httpx)

## Verification

- [x] `uv sync` — dependencies installed
- [x] `query_osv.py lodash npm` — returns 8 vulns with CVEs and fix versions
- [x] `query_github.py --cve CVE-2021-44228` — returns log4j advisory details
- [x] `query_ncsc.py --severity 2 --limit 3` — returns high-damage advisories
- [x] `query_cisa.py --keyword log4j` — returns 2 KEV entries
- [x] `scan_deps.py pyproject.toml` — scans deps, finds vulns in mcp and httpx
- [x] Slash command registered and visible in skills list
